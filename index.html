<!DOCTYPE html>
<html>
  <head>
    <style>
      #fileInput {
        display: none;
      }
  
      #uploadButton {
        position: absolute;
        top: 10%;
        left: 50%;
        transform: translate(-50%, -50%);
        padding: 10px 20px;
        border-radius: 25px;
        background-color: #4CAF50;
        color: white;
        cursor: pointer;
      }
  
      #clearButton {
        left: 70%;
        transform: translate(-70%, -50%);
      }
  
      body {
        cursor: default;
        user-select: none;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 0;
        margin: 0;
        background-color: #f0f0f0;
        overflow: hidden;
        font-family: Arial, sans-serif;
      }
  
      #fileContainer {
        position: absolute;
        top: 20%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        flex-direction: column;
        align-items: center;
      }
  
      .fileItem {
        margin: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
      }
  
      .fileItem img {
        width: 50px;
        height: 50px;
      }
  
      .dragover {
        background-color: #333;
      }

    </style>
  </head>
<body ondrop="dropHandler(event);" ondragover="dragOverHandler(event);" ondragleave="dragLeaveHandler(event);" onload="loadFiles();">
  <button id="uploadButton" onclick="document.getElementById('fileInput').click();">Seleccionar archivo</button>
  <!--button id="clearButton" onclick="clearFiles();">Limpiar archivos</button-->
  <input type="file" id="fileInput" onchange="handleFileSelect(event);" />
  <div id="fileContainer"></div>
  <script>
    function handleFileSelect(evt) {
      var file = evt.target.files[0];
      var reader = new FileReader();
      reader.onload = function(event) {
        var files = JSON.parse(sessionStorage.getItem('files') || '[]');
        files.push({ name: file.name, data: event.target.result });
        sessionStorage.setItem('files', JSON.stringify(files));
        addFileToContainer(file);
      };
      reader.readAsDataURL(file);
    }

    function dropHandler(ev) {
      ev.preventDefault();
      document.body.classList.remove('dragover');
      if (ev.dataTransfer.items) {
        for (var i = 0; i < ev.dataTransfer.items.length; i++) {
          if (ev.dataTransfer.items[i].kind === 'file') {
            var file = ev.dataTransfer.items[i].getAsFile();
            var reader = new FileReader();
            reader.onload = function(event) {
              var files = JSON.parse(sessionStorage.getItem('files') || '[]');
              files.push({ name: file.name, data: event.target.result });
              sessionStorage.setItem('files', JSON.stringify(files));
              addFileToContainer(file);
            };
            reader.readAsDataURL(file);
          }
        }
      }
    }

    function dragOverHandler(ev) {
      ev.preventDefault();
      document.body.classList.add('dragover');
    }

    function dragLeaveHandler(ev) {
      document.body.classList.remove('dragover');
    }

    function addFileToContainer(file, index) {
      var container = document.getElementById('fileContainer');
      var fileItem = document.createElement('div');
      fileItem.classList.add('fileItem');

      var fileName = document.createElement('span');
      fileName.style.flexGrow = 1;
      var name = file.name;
      if (name.length > 64) {
        var extension = name.slice((name.lastIndexOf(".") - 1 >>> 0) + 2);
        name = name.slice(0, 60) + '...' + extension;
      }
      fileName.textContent = name;
      fileName.title = file.name;
      fileItem.appendChild(fileName);

      var deleteButton = document.createElement('button');
      deleteButton.textContent = 'X';
      deleteButton.style.color = 'red';
      deleteButton.onclick = function() {
        removeFile(fileItem);
      };

      fileItem.appendChild(deleteButton);
      container.appendChild(fileItem);
                          
    }

    function loadFiles() {
      var files = JSON.parse(sessionStorage.getItem('files') || '[]');
      for (var i = 0; i < files.length; i++) {
        addFileToContainer({ name: files[i].name });
      }
    }

    function clearFiles() {
      sessionStorage.removeItem('files');
      document.getElementById('fileContainer').innerHTML = '';
    }

    function removeFile(fileItem) {
      var files = JSON.parse(sessionStorage.getItem('files') || '[]');
      var index = Array.from(fileItem.parentNode.children).indexOf(fileItem);
      files.splice(index, 1);
      sessionStorage.setItem('files', JSON.stringify(files));
      document.getElementById('fileContainer').innerHTML = '';
      for (var i = 0; i < files.length; i++) {
        addFileToContainer({ name: files[i].name }, i);
      }
    }

    function removeAllFiles() {
      var files = JSON.parse(sessionStorage.getItem('files') || '[]');
      files = [];
      sessionStorage.setItem('files', JSON.stringify(files));
      document.getElementById('fileContainer').innerHTML = '';
    }
  </script>
</body>
</html>